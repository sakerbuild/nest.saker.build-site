<!DOCTYPE html>
<html>
<head>

	<title>saker.nest</title>
	
	<meta name="theme-color" content="#ffffff">
	
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    
    <link rel="stylesheet" href="/bootstrap.min.css">
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
    
	<link id="css-nest" rel="stylesheet" href="/nestui.css">
</head>
<body class="userinfo-not-ready" >
	<script type="text/javascript">
		window.onstorage = function(e) {
			if(e.key == 'dark_theme') {
				var metaThemeColor = document.querySelector("meta[name=theme-color]");
				if(e.newValue == 'true'){
					document.body.classList.add('theme-dark');
    				metaThemeColor.setAttribute("content", "#202020" );
				}else{
					document.body.classList.remove('theme-dark');
    				metaThemeColor.setAttribute("content", "#ffffff");
				}
			}
		};
		(function(){
			let usedarktheme = localStorage.getItem("dark_theme");
			if(usedarktheme == 'true'){
				var metaThemeColor = document.querySelector("meta[name=theme-color]");
    			metaThemeColor.setAttribute("content", "#202020");
				document.body.classList.add('theme-dark');
			} else if(usedarktheme == null){
				if(window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches) {
					document.body.classList.add('theme-dark');
    				document.querySelector("meta[name=theme-color]").setAttribute("content", "#202020" );
			    }
			}
		})();
	</script>
	<nav class="navbar navbar-expand">
		<div class="container" id="menu" style="height: 50px; padding: 0 15px 0 15px; position: relative;">
			<div class="network-loading-indicator">
			</div>
			<div class="navbar-brand" style="position: relative;">
				<img style="height: 2.5rem;" class="logo" src="/res/logo.svg"/><a class="home-brand navbar-link" style="font-size: 1.2em;vertical-align: middle; margin-left: 0.2em;" title="saker.nest home" href="/">saker.nest</a>
				<a id="domain-nav-notification" class="navapidomain secondaryinfo display-if-nondefault-domain" href="/apidomain" title="Current API domain for the site"></a>
			</div>
			<ul class="navbar-nav mr-auto">	
				<li class="nav-item">
					<a href="/search" class="p-1 navbar-link" title="Search community packages"><svg class="d-md-none" style="height:1.5em;" viewBox="0 0 24 24">
    <path fill="currentColor" d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" />
</svg><span class="d-none d-md-inline">Search</span></a>
				</li>
				<li class="nav-item userinfo-loggedin-visible">
					<a href="/user/packages" class="p-1 navbar-link" title="Manage user packages"><svg class="d-md-none" style="height:1.5em;" viewBox="0 0 24 24">
    <path fill="currentColor" d="M21,16.5C21,16.88 20.79,17.21 20.47,17.38L12.57,21.82C12.41,21.94 12.21,22 12,22C11.79,22 11.59,21.94 11.43,21.82L3.53,17.38C3.21,17.21 3,16.88 3,16.5V7.5C3,7.12 3.21,6.79 3.53,6.62L11.43,2.18C11.59,2.06 11.79,2 12,2C12.21,2 12.41,2.06 12.57,2.18L20.47,6.62C20.79,6.79 21,7.12 21,7.5V16.5M12,4.15L10.11,5.22L16,8.61L17.96,7.5L12,4.15M6.04,7.5L12,10.85L13.96,9.75L8.08,6.35L6.04,7.5M5,15.91L11,19.29V12.58L5,9.21V15.91M19,15.91V9.21L13,12.58V19.29L19,15.91Z" />
</svg><span class="d-none d-md-inline">Manage packages<span/></a>
				</li>
			</ul>
			<ul class="navbar-nav">	
				<li class="nav-item networkloading-visible">
				</li>
				<li class="nav-item">
					<div id="userdropdown" class="userinfo-ready-visible dropdown">
						<button id="navloginbutton" class="dropdown-toggle simple-dropdown" 
								type="button" data-toggle="dropdown" style="white-space: nowrap;" aria-haspopup="true" aria-expanded="false">
							<svg class="usericon" style="width:24px;height:24px" viewBox="0 0 24 24">
							    <path fill="currentColor" d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" />
							</svg>
							<svg class="usericon-unverified" style="width:24px;height:24px" viewBox="0 0 24 24">
							    <path fill="currentColor" d="M10,4A4,4 0 0,1 14,8A4,4 0 0,1 10,12A4,4 0 0,1 6,8A4,4 0 0,1 10,4M10,14C14.42,14 18,15.79 18,18V20H2V18C2,15.79 5.58,14 10,14M20,12V7H22V12H20M20,16V14H22V16H20Z" />
							</svg>
							<span class="user-name-display"></span>
						</button>
						<div class="dropdown-menu dropdown-menu-right">
							<div class="dropdownsection userinfo-not-loggedin-visible">
								<form id="loginform" class="px-4 py-3">
									<div class="form-group">
										<label>Username
											<input type="text" name="username" placeholder="Username" autocomplete="username" required>
										</label>
										
									</div>
									<div class="form-group">
										<label>Password
											<div class="passwordcell">
												<input type="password" name="password" placeholder="Password" autocomplete="current-password" required>
												<div class="passwordmasker" ></div>
											</div>
										</label>
									</div>
									<button type="submit">Log in</button>
								</form>
							</div>
							<div class="dropdownsection userinfo-not-loggedin-visible">
								<a id="registerlink" class="dropdown-item" href="/register">Register new account</a>
								<a id="forgotpasswordlink" class="dropdown-item" href="/forgot/password">Forgot password?</a>
								<a id="forgotusernamelink" class="dropdown-item" href="/forgot/username">Forgot username?</a>
							</div>
							<div class="dropdownsection userinfo-loggedin-visible">
								<a id="managepackageslink" class="dropdown-item" href="/user/packages">Manage packages</a>
							</div>
							<div class="dropdownsection userinfo-loggedin-visible">
								<a id="resendverificationlink" class="notverified-visible dropdown-item" href="#">Resend verification mail</a>
								<a id="profilesettingslink" class="dropdown-item" href="/user/settings">User settings</a>
								<a id="logoutlink" class="dropdown-item" href="#">Logout</a>
							</div>
							<div class="dropdownsection">
								<a id="menu-theme-selector" class="dropdown-item" href="#"></a>
							</div>
						</div>
					</div>
				</li>
			</ul>
		</div>
	</nav>
	
	<div id="contentholder">
		<div id="content">
			<noscript>
				<div class="container text-center">
					<span class="p-3 d-block">
						The website uses JavaScript for displaying its contents. Please enable it to continue. <br>
						JavaScript is only used to render the site and we don't display ads or other third party content. 
					</span>
				</div>
			</noscript>
		</div>
	</div>
	<div id="toastcontainer" class="container">
		<div class="row">	
			<div class="offset-lg-3 col-lg-6 offset-md-2 col-md-8 col-sm-12">
				<div id="toastcontentcontainer">
				</div>
			</div>
		</div>
	</div>
	
	<footer class="footer">
		<div class="container">
			<div class="row">
				<div class="footer-section col-12 col-sm-4 col-md-3">
					<p class="footer-section-title">About</p>
					<a href="/" title="Saker.nest home">Home</a><br/>
					<a href="https://saker.build/saker.nest/doc/index.html" title="Overview about the saker.nest repository">What is saker.nest?</a><br/>
					<a href="https://saker.build" title="Saker.build system">Saker.build</a><br/>
					<a href="https://saker.build/saker.nest/doc/roadmap.html" title="Development roadmap for saker.nest">Roadmap</a><br/>
				</div>
				<div class="footer-section col-12 col-sm-4 col-md-3">
					<p class="footer-section-title">Resources</p>
					<a href="https://saker.build/saker.nest/doc/websiteguide/index.html" title="Documentation for using the saker.nest repository website">Documentation</a><br/>
					<a href="https://github.com/sakerbuild/saker.nest" title="Source repository for saker.nest">Source code</a><br/>
					<a href="/terms" title="Terms and conditions for saker.nest">Terms of service</a><br/>
					<a href="/privacy" title="Privacy policy for saker.nest">Privacy policy</a><br/>
				</div>
				<div class="footer-section col-12 col-sm-4 col-md-3">
					<p class="footer-section-title">Contact</p>
					<a href="https://github.com/sakerbuild/saker.nest/issues" title="Reporting user issues with saker.nest">Issue tracker</a><br/>
					<a href="https://saker.build/contact.html" title="Contact saker.nest support">Contact</a><br/>
					<a href="https://saker.build/contact.html" title="Direct help with encountered user issues">Support</a><br/>
				</div>
			</div>
			<div class="row">
				<div class="col">
				&copy; Bence Sipka 2020
				</div>
			</div>
		</div>
    </footer>
	
	<script src="/jquerypopperbootstrap.min.js"></script>
	
	<script src="/nest.js" type="text/javascript"></script>
	<script src="/nest_client.js" type="text/javascript"></script>
	
	<script type="text/javascript">
		nestclient.userinfo.ready(function(){
			document.body.classList.remove('userinfo-not-ready');
		});
		$(document).ready(function(){
			let sheet = window.document.styleSheets[0];
			sheet.insertRule(`
				body[data-api-domain="${ nest.DEFAULT_API_DOMAIN.replace(/"/g, '&quot;') }"] .display-if-nondefault-domain {
					display:none;
				}
				`, sheet.cssRules.length);
				
			
			$('.navbar-link').nestLinkify();
			$('#domain-nav-notification').text(nest.apidomain).nestLinkify();
			$('footer a[href^="/"]').nestLinkify();
			$('body').attr("data-api-domain", nest.apidomain);
			$('div.passwordmasker').replaceWith($(nestclient.passwordmarkerhtml));
			nestclient.createpasswordmasker($('#userdropdown .passwordmasker'));
			$('#userdropdown #menu-theme-selector').click(function(e){
				$('body').toggleClass('theme-dark');
				let isdark = $('body').hasClass('theme-dark');
				localStorage.setItem("dark_theme", isdark);
				var metaThemeColor = document.querySelector("meta[name=theme-color]");
				if(isdark){
					document.body.classList.add('theme-dark');
					metaThemeColor.setAttribute("content", "#202020" );
				}else{
					document.body.classList.remove('theme-dark');
					metaThemeColor.setAttribute("content", "#ffffff" );
				}
				e.preventDefault();
			});
			$("#userdropdown #loginform").submit(function(e){
			    var form = $(this);
			    var uname = form.find('input[name="username"]').val();
			    var pass = form.find('input[name="password"]').val();
			    nest.user.login(uname, pass)
			    .done(function(response){
			    	nestclient.setSession(response.session);
			    	nestclient.updatelogininfo(response.info);
			    }).fail(function(xhr){
			    	nestclient.updatelogininfo(null);
			    	nestclient.unexpectedRequestError(xhr);
			    }).always(function(){
			    	form.find('input[name="password"]').val('');
			    });
			    e.preventDefault();
			    $(function () {
				   $('#userdropdown #userdropdown').dropdown('toggle');
				});
			    return false;
			});
			$('#userdropdown #managepackageslink').nestLinkify();
			$('#userdropdown #profilesettingslink').nestLinkify();
			$('#userdropdown #logoutlink').click(function(e){
				nestclient.navigateNoUnsaved(function(){
				 	nestclient.setSession(null);
				 	nestclient.updatelogininfo(null);
				 	e.preventDefault();
				});
			});
			$('#userdropdown #registerlink').nestLinkify();
			$('#userdropdown #forgotpasswordlink').nestLinkify();
			$('#userdropdown #forgotusernamelink').nestLinkify();
			$('#userdropdown').on('shown.bs.dropdown', function() {
				$('#userdropdown #userdropdown input[name="username"]').focus();
			});
			$('#userdropdown #resendverificationlink').click(function(e){
				nestclient.resendVerification();
				e.preventDefault();
			});
		});
	</script>
	
</body>
</html>